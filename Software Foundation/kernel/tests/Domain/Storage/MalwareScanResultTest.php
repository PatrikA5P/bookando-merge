<?php

declare(strict_types=1);

namespace SoftwareFoundation\Kernel\Tests\Domain\Storage;

use PHPUnit\Framework\TestCase;
use SoftwareFoundation\Kernel\Domain\Storage\MalwareScanResult;

final class MalwareScanResultTest extends TestCase
{
    public function testCleanResult(): void
    {
        $at = new \DateTimeImmutable('2025-06-01T12:00:00+00:00');
        $result = MalwareScanResult::clean('ClamAV', $at);
        self::assertTrue($result->clean);
        self::assertNull($result->threatName);
        self::assertSame('ClamAV', $result->scanner);
        self::assertSame($at, $result->scannedAt);
    }

    public function testThreatResult(): void
    {
        $at = new \DateTimeImmutable('2025-06-01T12:00:00+00:00');
        $result = MalwareScanResult::threat('Trojan.GenericKD', 'ClamAV', $at);
        self::assertFalse($result->clean);
        self::assertSame('Trojan.GenericKD', $result->threatName);
        self::assertSame('ClamAV', $result->scanner);
    }
}
