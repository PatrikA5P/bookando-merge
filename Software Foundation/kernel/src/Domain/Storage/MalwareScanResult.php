<?php

declare(strict_types=1);

namespace SoftwareFoundation\Kernel\Domain\Storage;

final class MalwareScanResult
{
    public function __construct(
        public readonly bool $clean,
        public readonly ?string $threatName,
        public readonly \DateTimeImmutable $scannedAt,
        public readonly string $scanner,
    ) {
    }

    public static function clean(string $scanner, \DateTimeImmutable $at): self
    {
        return new self(
            clean: true,
            threatName: null,
            scannedAt: $at,
            scanner: $scanner,
        );
    }

    public static function threat(string $threatName, string $scanner, \DateTimeImmutable $at): self
    {
        return new self(
            clean: false,
            threatName: $threatName,
            scannedAt: $at,
            scanner: $scanner,
        );
    }
}
